(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4ba9e641"],{"00f4":function(t,o,s){},"35e7":function(t,o,s){},3871:function(t,o,s){},"5e1a":function(t,o,s){},"65b6":function(t,o,s){"use strict";var n=s("3871"),a=s.n(n);a.a},"9b49":function(t,o,s){"use strict";var n=s("5e1a"),a=s.n(n);a.a},b9d0:function(t,o,s){"use strict";var n=s("35e7"),a=s.n(n);a.a},e0a9:function(t,o,s){"use strict";s.r(o);var n=function(){var t=this,o=t.$createElement,s=t._self._c||o;return t.shopInfo?s("div",{staticClass:"goods"},[t._l(t.shopInfo.recommend,(function(o,n){return s("div",{key:n,staticClass:"recommend"},[s("p",{staticClass:"recommend-name"},[t._v(t._s(o.name))]),s("div",{staticClass:"recommend-wrap"},[s("ul",t._l(o.items,(function(o,n){return s("li",{key:n},[s("img",{attrs:{src:o.image_path,alt:""}}),s("div",{staticClass:"recommend-food"},[s("p",{staticClass:"recommend-food-name"},[t._v(t._s(o.name))]),s("p",{staticClass:"recommend-food-zm"},[t._v("\n              "+t._s(o.month_sales)+"好评率"+t._s(o.satisfy_rate)+"\n            ")])]),s("div",{staticClass:"recommend-food-price"},[s("p",[t._v("¥"+t._s(o.activity.fixed_price))]),s("cart-controll",{attrs:{food:o}})],1)])})),0)])])})),s("div",{staticClass:"menuview"},[s("div",{ref:"menuScroll",staticClass:"menu-wrapper"},[s("ul",t._l(t.shopInfo.menu,(function(o,n){return s("li",{key:n,class:{current:t.currentIndex===n},on:{click:function(o){return t.selectMenu(n)}}},[o.icon_url?s("img",{attrs:{src:o.icon_url,alt:""}}):t._e(),s("span",[t._v(t._s(o.name))])])})),0)]),s("div",{ref:"foodScroll",staticClass:"foods-wrapper"},[s("ul",t._l(t.shopInfo.menu,(function(o,n){return s("li",{key:n,staticClass:"food-list-hook"},[s("div",{staticClass:"category-title"},[s("strong",[t._v(t._s(o.name))]),s("span",[t._v(t._s(o.description))])]),t._l(o.foods,(function(o,n){return s("div",{key:n,staticClass:"fooddetails",on:{click:function(s){return t.handle(o)}}},[s("img",{attrs:{src:o.image_path,alt:""}}),s("section",{staticClass:"fooddetails-info"},[s("h4",[t._v(t._s(o.name))]),s("p",{staticClass:"fooddetails-des"},[t._v(t._s(o.description))]),s("p",{staticClass:"fooddetails-sales"},[t._v("\n                月售"+t._s(o.month_sales)+"份 好评率"+t._s(o.satisfy_rate)+"\n              ")]),s("div",{staticClass:"fooddetails-price"},[s("span",{staticClass:"price"},[t._v("¥"+t._s(o.activity.fixed_price))]),s("CartControll",{attrs:{food:o}})],1)])])}))],2)})),0)])]),s("shop-cart",{attrs:{shopInfo:t.shopInfo}}),s("food",{attrs:{food:t.detailFood,isShow:t.showFood},on:{close:function(o){t.showFood=!1}}})],2):t._e()},a=[],i=(s("6d57"),function(){var t=this,o=t.$createElement,s=t._self._c||o;return s("div",{staticClass:"cartcontroll"},[t.food.count>0?s("span",{staticClass:"cartbutton button-minus",on:{click:function(o){return o.stopPropagation(),t.decreaseCount(o)}}},[s("i",{staticClass:"fa fa-minus"})]):t._e(),t.food.count>0?s("span",{staticClass:"cartcount"},[t._v(t._s(t.food.count))]):t._e(),s("span",{staticClass:"cartbutton",on:{click:function(o){return o.stopPropagation(),t.increaseCount(o)}}},[s("i",{staticClass:"fa fa-plus-circle"})])])}),e=[],c={name:"cartcontroll",props:{food:Object},methods:{decreaseCount:function(){this.food.count--},increaseCount:function(){this.food.count++}}},r=c,l=(s("b9d0"),s("9ca4")),f=Object(l["a"])(r,i,e,!1,null,"1039dbac",null),u=f.exports,d=s("ecd2"),h=function(){var t=this,o=t.$createElement,s=t._self._c||o;return s("div",{staticClass:"shopcart"},[s("transition",{attrs:{name:"fade"}},[t.showCartView&&!t.isEmpty?s("div",{staticClass:"cartview-cartmask",on:{click:function(o){if(o.target!==o.currentTarget)return null;t.showCartView=!1}}},[s("div",{staticClass:"cartview-cartbody"},[s("div",{staticClass:"cartview-cartheader"},[s("span",[t._v("已选商品")]),s("button",{on:{click:t.clearFoods}},[s("i",{staticClass:"fa fa-trash-o"}),s("span",[t._v("清空")])])]),s("div",{staticClass:"entityList-cartbodyScroller"},[s("ul",{staticClass:"entityList-cartlist"},t._l(t.selectFoods,(function(o,n){return s("li",{key:n,staticClass:"entityList-entityrow"},[s("h4",[s("span",[t._v(t._s(o.name))])]),s("span",{staticClass:"entityList-entitytotal"},[t._v(t._s(o.activity.fixed_price))]),s("CartControll",{attrs:{food:o}})],1)})),0)])])]):t._e()]),s("div",{staticClass:"bottomNav-cartFooter",class:{"bottomNav-cartIcon-empty":t.isEmpty}},[s("span",{staticClass:"bottomNav-cartIcon",on:{click:function(o){t.showCartView=!t.showCartView}}},[s("i",{staticClass:"fa fa-cart-plus"}),t.totalCount?s("span",[t._v(t._s(t.totalCount))]):t._e()]),s("div",{staticClass:"bottomNav-cartInfo",on:{click:function(o){t.showCartView=!t.showCartView}}},[s("p",{staticClass:"bottomNav-cartTotal"},[t.isEmpty?s("span",[t._v("未选购商品")]):s("span",[t._v("¥"+t._s(t.totalPrice.toFixed(2)))])]),s("p",{staticClass:"bottomNav-cartDelivery"},[t._v("\n        另需配送费"+t._s(t.shopInfo.rst.float_delivery_fee)+"元\n      ")])]),s("button",{staticClass:"submit-btn"},[t.isEmpty?s("span",[t._v("￥"+t._s(t.shopInfo.rst.float_minimum_order_amount)+"元起送")]):s("span",{on:{click:t.settlement}},[t._v("去结算")])])])],1)},p=[],m={name:"shopcart",props:{shopInfo:Object},created:function(){console.log(this.shopInfo)},data:function(){return{totalCount:0,totalPrice:0,selectFoods:[],showCartView:!1}},computed:{isEmpty:function(){var t=this,o=!0;return this.totalCount=0,this.totalPrice=0,this.selectFoods=[],this.shopInfo.recommend.forEach((function(s){s.items.forEach((function(s){s.count&&(o=!1,t.totalCount+=s.count,t.totalPrice+=s.activity.fixed_price*s.count,t.selectFoods.push(s))}))})),this.shopInfo.menu.forEach((function(s){s.foods.forEach((function(s){s.count&&(o=!1,t.totalCount+=s.count,t.totalPrice+=s.activity.fixed_price*s.count,t.selectFoods.push(s))}))})),o}},components:{CartControll:u},methods:{clearFoods:function(){this.shopInfo.recommend.forEach((function(t){t.items.forEach((function(t){t.count=0}))})),this.shopInfo.menu.forEach((function(t){t.foods.forEach((function(t){t.count=0}))}))},settlement:function(){this.$store.dispatch("setOrderInfo",{shopInfo:this.shopInfo.rst,selectFoods:this.selectFoods}),this.$router.push("/settlement")}}},_=m,v=(s("ffd1"),Object(l["a"])(_,h,p,!1,null,"e0d7bf40",null)),C=v.exports,b=function(){var t=this,o=t.$createElement,s=t._self._c||o;return s("transition",{attrs:{name:"move"}},[t.isShow?s("div",{staticClass:"food"},[s("div",{staticClass:"foodPanel-close",on:{click:function(o){return t.$emit("close")}}},[s("i",{staticClass:"fa fa-close"})]),s("div",{staticClass:"foodPanel-body"},[s("div",{staticClass:"foodPanel-foodimg"},[s("img",{attrs:{src:t.food.image_path,alt:""}})]),s("div",{staticClass:"foodPanel-foodInfo"},[s("h4",[t._v(t._s(t.food.name))]),s("div",{staticClass:"foodPanel-foodSales"},[s("span",[t._v("月售"+t._s(t.food.month_sales))]),s("span",[t._v("好评率 "+t._s(t.food.satisfy_rate)+"%")])]),s("div",{staticClass:"foodPanel-priceLine"},[s("span",[t._v("¥"+t._s(t.food.activity.fixed_price))]),s("CartControll",{staticClass:"cart-btn",attrs:{food:t.food}})],1),s("p",[t._v(t._s(t.food.description))])])])]):t._e()])},w=[],y={name:"food",props:{food:Object,isShow:Boolean},components:{CartControll:u}},g=y,k=(s("65b6"),Object(l["a"])(g,b,w,!1,null,"ece5b50c",null)),I=k.exports,E={name:"goods",data:function(){return{shopInfo:null,menuScroll:{},foodScroll:{},scrollY:0,listHeight:[],detailFood:null,showFood:!1}},created:function(){this.getData()},computed:{currentIndex:function(){for(var t=0;t<this.listHeight.length;t++){var o=this.listHeight[t],s=this.listHeight[t+1];if(this.scrollY>=o&&this.scrollY<s)return t}return 0}},methods:{handle:function(t){this.detailFood=t,this.showFood=!0},getData:function(){var t=this;this.axios("/api/profile/batch_shop").then((function(o){o.data.recommend.forEach((function(t){t.items.forEach((function(t){return t.count=0}))})),o.data.menu.forEach((function(t){t.foods.forEach((function(t){t.count=0}))})),t.shopInfo=o.data,console.log(t.shopInfo),t.$nextTick((function(){t.initScroll(),t.calculateHeight()}))}))},initScroll:function(){var t=this;this.menuScroll=new d["a"](this.$refs.menuScroll,{click:!0}),this.foodScroll=new d["a"](this.$refs.foodScroll,{probeType:3,click:!0}),this.foodScroll.on("scroll",(function(o){t.scrollY=Math.abs(Math.round(o.y))}))},selectMenu:function(t){var o=document.querySelectorAll(".food-list-hook");o[t];this.foodScroll.scrollToElement(o[t],250)},calculateHeight:function(){var t=document.querySelectorAll(".food-list-hook"),o=0;this.listHeight.push(o);for(var s=0;s<t.length-1;s++){var n=t[s];o+=n.clientHeight,this.listHeight.push(o)}console.log(this.listHeight)}},components:{CartControll:u,ShopCart:C,Food:I}},S=E,F=(s("9b49"),Object(l["a"])(S,n,a,!1,null,"10d807c6",null));o["default"]=F.exports},ffd1:function(t,o,s){"use strict";var n=s("00f4"),a=s.n(n);a.a}}]);
//# sourceMappingURL=chunk-4ba9e641.bda14bc3.js.map